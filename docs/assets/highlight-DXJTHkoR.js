(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();function h(t){const r=t.split(`
`),e=r[r.length-1]===""?r.slice(0,-1):r;if(e.length===0)throw new Error("Empty file");const s=e[0].match(/^#\s+INGR\.io\s+\|\s+(.+?):\s+(.+)$/);if(!s)throw new Error("Invalid INGR header. Expected: # INGR.io | name: $ID, col2, ...");const o=s[1].trim(),n=s[2].split(",").map(u=>u.trim()),c=n.length;let i=e.length;for(let u=e.length-1;u>=1;u--)if(/^#\s+\d+\s+records?$/.test(e[u].trim())){i=u;break}const l=[];for(let u=1;u<i;u++){const p=e[u];p.startsWith("#")||l.push(p)}if(l.length%c!==0)throw new Error(`Data line count (${l.length}) is not divisible by column count (${c}). Expected ${c} lines per record.`);const a=[];for(let u=0;u<l.length;u+=c){const p={};for(let d=0;d<c;d++){const S=n[d].replace(/^\$/,""),y=l[u+d].trim();try{p[S]=JSON.parse(y)}catch{throw new Error(`Invalid JSON value on line ${u+d+2}: ${y}`)}}a.push(p)}return{recordsetName:o,columns:n,records:a}}function f(t,r=!1){const{recordsetName:e,columns:s,records:o}=t,n=[];n.push(`# INGR.io | ${e}: ${s.join(", ")}`);for(let i=0;i<o.length;i++){for(const l of s){const a=l.replace(/^\$/,"");n.push(JSON.stringify(o[i][a]??null))}r&&i<o.length-1&&n.push("#")}const c=o.length;return n.push(`# ${c} ${c===1?"record":"records"}`),n.join(`
`)}function m(t,r="data"){if(t.length===0)return{recordsetName:r,columns:["$ID"],records:[]};const e=new Set;for(const i of t)Object.keys(i).forEach(l=>e.add(l));const s=Array.from(e);let o=s.find(i=>i.toLowerCase()==="id")??s[0];const n=s.filter(i=>i!==o),c=[`$${o}`,...n];return{recordsetName:r,columns:c,records:t}}function v(t){const r=JSON.parse(t),e=Array.isArray(r)?r:[r];return f(m(e))}function w(t){const r=t.trim().split(`
`).filter(Boolean).map(e=>JSON.parse(e));return f(m(r))}function b(t){const r=O(t,",");return f(m(r))}function I(t){const r=O(t,"	");return f(m(r))}function T(t){const r=L(t);return f(m(r))}function E(t){const r=W(t);return f(m(r))}function P(t,r,e,s){const o=s?.ingrDelimiter??!1;if(r===e)return r==="ingr"?f(h(t),o):t;let n;if(r==="ingr")n=h(t);else{const c=x(t,r);n=h(c)}switch(e){case"ingr":return f(n,o);case"json":return JSON.stringify(n.records,null,2);case"jsonl":return n.records.map(c=>JSON.stringify(c)).join(`
`);case"csv":return N(n.records,",");case"tsv":return N(n.records,"	");case"yaml":return J(n.records);case"xml":return M(n.records,n.recordsetName);case"markdown":return k(n.records)}}function x(t,r){switch(r){case"json":return v(t);case"jsonl":return w(t);case"csv":return b(t);case"tsv":return I(t);case"yaml":return T(t);case"xml":return E(t);default:throw new Error(`Cannot convert from ${r} to INGR`)}}function O(t,r){const e=t.trim().split(`
`).filter(Boolean);if(e.length<2)throw new Error("CSV must have a header row and at least one data row");const s=j(e[0],r),o=[];for(let n=1;n<e.length;n++){const c=j(e[n],r),i={};for(let l=0;l<s.length;l++){const a=c[l]??"";i[s[l]]=g(a)}o.push(i)}return o}function j(t,r){const e=[];let s="",o=!1;for(let n=0;n<t.length;n++){const c=t[n];c==='"'?o&&t[n+1]==='"'?(s+='"',n++):o=!o:c===r&&!o?(e.push(s),s=""):s+=c}return e.push(s),e}function g(t){if(t===""||t.toLowerCase()==="null")return null;if(t.toLowerCase()==="true")return!0;if(t.toLowerCase()==="false")return!1;const r=Number(t);return!isNaN(r)&&t.trim()!==""?r:t}function N(t,r){if(t.length===0)return"";const e=Object.keys(t[0]),s=r===","?n=>n.includes(",")||n.includes('"')||n.includes(`
`)?`"${n.replace(/"/g,'""')}"`:n:n=>n;return[e.map(s).join(r),...t.map(n=>e.map(c=>{const i=n[c],l=i==null?"":String(i);return s(l)}).join(r))].join(`
`)}function L(t){const r=t.split(`
`),e=[];let s=null;for(const o of r){const n=o.trimEnd();if(!(n.trim()===""||n.trim()==="---")){if(/^- /.test(n)){s!==null&&e.push(s),s={};const c=n.replace(/^- /,"");if(c.trim()){const i=$(c);i&&s&&(s[i[0]]=i[1])}}else if(/^\s+/.test(n)&&s!==null){const c=$(n.trim());c&&(s[c[0]]=c[1])}}}return s!==null&&e.push(s),e}function $(t){const r=t.indexOf(":");if(r===-1)return null;const e=t.slice(0,r).trim(),s=t.slice(r+1).trim();return[e,C(s)]}function C(t){if(t===""||t==="null"||t==="~")return null;if(t==="true")return!0;if(t==="false")return!1;if(t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"'))return t.slice(1,-1);const r=Number(t);return!isNaN(r)&&t!==""?r:t}function J(t){return t.map(r=>"- "+Object.keys(r).map((s,o)=>{const n=r[s],c=`${s}: ${A(n)}`;return o===0?c:"  "+c}).join(`
`)).join(`
`)}function A(t){return t==null?"null":typeof t=="boolean"||typeof t=="number"?String(t):typeof t=="string"?/[:#\[\]{},&*!|>'"@`]/.test(t)||t.includes(`
`)||t===""?`"${t.replace(/"/g,'\\"')}"`:t:`"${JSON.stringify(t).replace(/"/g,'\\"')}"`}function W(t){const e=new DOMParser().parseFromString(t,"text/xml"),s=e.querySelector("parsererror");if(s)throw new Error("Invalid XML: "+s.textContent);const o=e.documentElement,n=[],c=Array.from(o.children);for(const i of c){const l={};if(i.children.length>0)for(const a of Array.from(i.children))l[a.tagName]=g(a.textContent??"");else{for(const a of Array.from(i.attributes))l[a.name]=g(a.value);i.textContent?.trim()&&(l.value=i.textContent.trim())}n.push(l)}return n}function M(t,r){const e=r.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,""),s=e.endsWith("s")?e.slice(0,-1):"record",o=['<?xml version="1.0" encoding="UTF-8"?>',`<${e}>`];for(const n of t){o.push(`  <${s}>`);for(const[c,i]of Object.entries(n)){const l=c.replace(/[^a-zA-Z0-9_-]/g,"_"),a=i==null?"":R(String(i));o.push(`    <${l}>${a}</${l}>`)}o.push(`  </${s}>`)}return o.push(`</${e}>`),o.join(`
`)}function R(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function k(t){if(t.length===0)return"";const r=Object.keys(t[0]),e=r.map(i=>Math.max(i.length,...t.map(l=>String(l[i]??"").length))),s=(i,l)=>i.padEnd(l),o="| "+r.map((i,l)=>s(i,e[l])).join(" | ")+" |",n="| "+e.map(i=>"-".repeat(i)).join(" | ")+" |",c=t.map(i=>"| "+r.map((l,a)=>s(String(i[l]??""),e[a])).join(" | ")+" |");return[o,n,...c].join(`
`)}function _(t){const r=t.trim();if(!r)return null;if(/^#\s+INGR\.io\s+\|/.test(r))return"ingr";if(r.startsWith("<?xml")||/^<[a-zA-Z]/.test(r))return"xml";if(r.startsWith("[")&&r.endsWith("]")||r.startsWith("{")&&r.endsWith("}"))try{return JSON.parse(r),"json"}catch{}const e=r.split(`
`).filter(Boolean);if(e.length>=2&&e.every(n=>{try{const c=JSON.parse(n.trim());return typeof c=="object"&&c!==null}catch{return!1}}))return"jsonl";if(e.length===1)try{if(typeof JSON.parse(e[0])=="object")return"json"}catch{}if(r.startsWith("---")||/^- \w+:/.test(r)||/^\w+:\s+/.test(r))return"yaml";const s=r.split(`
`).filter(Boolean).slice(0,5);if(s.length>=2){const o=(s[0].match(/,/g)??[]).length;if(o>0&&s.slice(1).every(c=>{const i=(c.match(/,/g)??[]).length;return Math.abs(i-o)<=1}))return"csv"}return s.length>=2&&s[0].includes("	")?"tsv":null}function G(t){return{json:"json",jsonl:"jsonl",ndjson:"jsonl",csv:"csv",tsv:"tsv",yaml:"yaml",yml:"yaml",xml:"xml",ingr:"ingr"}[t.toLowerCase()]??null}const D=[".json",".jsonl",".csv",".tsv",".yaml",".yml",".xml",".ingr"],B={ingr:"INGR",json:"JSON",jsonl:"JSONL",csv:"CSV",tsv:"TSV",yaml:"YAML",xml:"XML",markdown:"Markdown"},U=["json","jsonl","csv","tsv","yaml","xml","ingr"],V=["json","jsonl","csv","tsv","yaml","xml","markdown"];function X(t){return t==="ingr"?"json":"ingr"}function F(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Y(t){return t?t.split(`
`).map(r=>{const e=F(r);if(r.startsWith("#"))return`<span class="hl-meta">${e}</span>`;try{const s=JSON.parse(r.trim());return s===null?`<span class="hl-null">${e}</span>`:typeof s=="boolean"?`<span class="hl-bool">${e}</span>`:typeof s=="number"?`<span class="hl-number">${e}</span>`:typeof s=="string"?`<span class="hl-string">${e}</span>`:`<span class="hl-object">${e}</span>`}catch{return e}}).join(`
`):""}export{B as F,U as I,D as S,V as a,X as b,P as c,_ as d,G as e,Y as h};

import{d as q,F as O,c as J,h as Q,I as V,a as tt,e as et,S as nt,b as D}from"./highlight-BNcuc9BJ.js";const w="ingr-preferred-output-format",ot={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function N(i){if(i===0)return"0 bytes";const s=Math.abs(i),B=s/(1024*1024),I=s/1024;if(s>=1024*1024){const o=Math.round(B*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(s>=1024){const o=Math.round(I*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(s)} bytes`}function at(){const i=document.getElementById("input-area"),s=document.getElementById("output-area"),B=document.getElementById("input-tabs"),I=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),K=document.getElementById("output-tabs-spacer"),W=document.getElementById("convert-btn"),z=document.getElementById("clear-btn"),u=document.getElementById("copy-btn"),G=document.getElementById("download-btn"),m=document.getElementById("detect-status"),A=document.getElementById("output-format-label"),y=document.getElementById("output-stats"),l=document.getElementById("drop-zone"),S=document.getElementById("drop-overlay"),x=document.getElementById("file-input"),R=document.getElementById("output-delimiter"),U=document.getElementById("output-sha256");let p=null,r=localStorage.getItem(w)??"ingr",b="";function f(t,e=!1){b=e?"":t,s.classList.toggle("error",e),e?s.textContent=t:t&&Y()==="ingr"?s.innerHTML=Q(t):s.textContent=t}function $(){B.innerHTML=V.map(t=>`<button class="format-tab${t===p?" active":""}" data-fmt="${t}">${O[t]}</button>`).join("")}function M(){const t=p==="ingr";o.style.display=t?"block":"none",K.style.display=t?"none":"block",t&&(I.innerHTML=tt.map(e=>`<button class="format-tab${e===r?" active":""}" data-fmt="${e}">${O[e]}</button>`).join(""))}function C(t,e=!1){p=t,$(),t&&t!=="ingr"&&(r=localStorage.getItem(w)??D(t)),M(),v(),e&&g()}function X(t){r=t,localStorage.setItem(w,t),M(),v(),g()}function Y(){return p==="ingr"?r:"ingr"}function v(){r?A.textContent=`● ${O[r]??r}`:A.textContent=""}async function g(){const t=i.value.trim();if(!t){f(""),y.textContent="";return}let e=p;if(!e)if(e=q(t),e)C(e),m.textContent=`Detected: ${O[e]}`;else{f(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),m.textContent="",y.textContent="";return}const c=e==="ingr"?r:D(e);try{const n={ingrDelimiter:R.checked};let a=J(t,e,c,n);if(U.checked&&c==="ingr"){const E=new TextEncoder().encode(a),L=await crypto.subtle.digest("SHA-256",E),T=Array.from(new Uint8Array(L)).map(h=>h.toString(16).padStart(2,"0")).join("");a=a+`
# sha256:`+T}f(a);const Z=a.split(`
`).length,_=new TextEncoder().encode(a).length,k=new TextEncoder().encode(i.value).length;let H=_;if(r==="ingr"){const d=a.match(/:\s*/);if(d){const E=d.index+d[0].length,L=a.indexOf(`
`,E)+1;let F=a.length;const T=a.split(`
`);for(let h=T.length-1;h>0;h--)if(T[h].startsWith("#")){F=a.lastIndexOf(T[h]);break}H=F-L}}let P=`${Z} lines · ${N(_)}`;if(k>0){const d=H-k,E=Math.round(d/k*100),L=d<0?"−":"+";P+=` · ${L}${Math.abs(E)}% (${N(Math.abs(d))})`}y.textContent=P,v()}catch(n){f(n instanceof Error?n.message:String(n),!0),y.textContent=""}}B.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(C(e.dataset.fmt),m.textContent="")}),I.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&X(e.dataset.fmt)}),W.addEventListener("click",()=>{m.textContent="",g()}),z.addEventListener("click",()=>{i.value="",f(""),p=null,m.textContent="",y.textContent="",$(),M(),v()}),u.addEventListener("click",async()=>{if(!b)return;await navigator.clipboard.writeText(b);const t=u.innerHTML;u.innerHTML="<span>✓</span> Copied",u.classList.add("flash-success"),setTimeout(()=>{u.innerHTML=t,u.classList.remove("flash-success")},1500)}),G.addEventListener("click",()=>{if(!b)return;const t=ot[r]??".txt",e=new Blob([b],{type:"text/plain;charset=utf-8"}),c=URL.createObjectURL(e),n=document.createElement("a");n.href=c,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(c)});function j(t){const e=t.name.split(".").pop()??"",c=et(e);if(!c){f(`Unsupported file type ".${e}".

Supported file extensions: ${nt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{i.value=n.result,C(c),m.textContent=`Loaded: ${t.name}`,g()},n.readAsText(t)}x.addEventListener("change",()=>{x.files?.[0]&&j(x.files[0]),x.value=""}),l.addEventListener("dragover",t=>{t.preventDefault(),l.classList.add("drag-over"),S.style.display="flex"}),l.addEventListener("dragleave",t=>{l.contains(t.relatedTarget)||(l.classList.remove("drag-over"),S.style.display="none")}),l.addEventListener("drop",t=>{t.preventDefault(),l.classList.remove("drag-over"),S.style.display="none";const e=t.dataTransfer?.files[0];e&&j(e)}),R.addEventListener("change",g),U.addEventListener("change",g),$(),M(),v()}document.addEventListener("DOMContentLoaded",at);

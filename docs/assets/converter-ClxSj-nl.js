import{d as q,F as O,c as J,h as Q,I as V,a as tt,e as et,S as nt,b as D}from"./highlight-BNcuc9BJ.js";const w="ingr-preferred-output-format",ot={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function N(i){if(i===0)return"0 bytes";const s=Math.abs(i),B=s/(1024*1024),I=s/1024;if(s>=1024*1024){const o=Math.round(B*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(s>=1024){const o=Math.round(I*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(s)} bytes`}function at(){const i=document.getElementById("input-area"),s=document.getElementById("output-area"),B=document.getElementById("input-tabs"),I=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),K=document.getElementById("output-tabs-spacer"),W=document.getElementById("convert-btn"),z=document.getElementById("clear-btn"),m=document.getElementById("copy-btn"),G=document.getElementById("download-btn"),p=document.getElementById("detect-status"),A=document.getElementById("output-format-label"),b=document.getElementById("output-stats"),l=document.getElementById("drop-zone"),$=document.getElementById("drop-overlay"),x=document.getElementById("file-input"),R=document.getElementById("output-delimiter"),U=document.getElementById("output-sha256");let f=null,r=localStorage.getItem(w)??"ingr",v="";function g(t,e=!1){v=e?"":t,s.classList.toggle("error",e),e?s.textContent=t:t&&Y()==="ingr"?s.innerHTML=Q(t):s.textContent=t}function S(){B.innerHTML=V.map(t=>`<button class="format-tab${t===f?" active":""}" data-fmt="${t}">${O[t]}</button>`).join("")}function M(){const t=f==="ingr";o.style.display=t?"block":"none",K.style.display=t?"none":"block",t&&(I.innerHTML=tt.map(e=>`<button class="format-tab${e===r?" active":""}" data-fmt="${e}">${O[e]}</button>`).join(""))}function C(t,e=!1){f=t,S(),t&&t!=="ingr"&&(r=localStorage.getItem(w)??D(t)),M(),E(),e&&h()}function X(t){r=t,localStorage.setItem(w,t),M(),E(),h()}function Y(){return f==="ingr"?r:"ingr"}function E(){r?A.textContent=`● ${O[r]??r}`:A.textContent=""}async function h(){const t=i.value.trim();if(!t){g(""),b.textContent="";return}let e=f;if(!e)if(e=q(t),e)C(e),p.textContent=`Detected: ${O[e]}`;else{g(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),p.textContent="",b.textContent="";return}const c=e==="ingr"?r:D(e);try{const n={ingrDelimiter:R.checked};let a=J(t,e,c,n);if(U.checked&&c==="ingr"){const L=new TextEncoder().encode(a),T=await crypto.subtle.digest("SHA-256",L),y=Array.from(new Uint8Array(T)).map(u=>u.toString(16).padStart(2,"0")).join("");a=a+`
# sha256:`+y}g(a);const Z=a.split(`
`).length,_=new TextEncoder().encode(a).length,k=new TextEncoder().encode(i.value).length;let H=_;if(r==="ingr"){const d=a.match(/:\s*/);if(d){const L=d.index+d[0].length,T=a.indexOf(`
`,L)+1;let F=a.length;const y=a.split(`
`);for(let u=y.length-1;u>=0;u--)if(y[u].startsWith("#")&&!/^#\s+\d+\s+records?$/.test(y[u].trim())){F=a.lastIndexOf(y[u]);break}H=F-T}}let P=`${Z} lines · ${N(_)}`;if(k>0){const d=H-k,L=Math.round(d/k*100),T=d<0?"−":"+";P+=` · ${T}${Math.abs(L)}% (${N(Math.abs(d))})`}b.textContent=P,E()}catch(n){g(n instanceof Error?n.message:String(n),!0),b.textContent=""}}B.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(C(e.dataset.fmt),p.textContent="")}),I.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&X(e.dataset.fmt)}),W.addEventListener("click",()=>{p.textContent="",h()}),z.addEventListener("click",()=>{i.value="",g(""),f=null,p.textContent="",b.textContent="",S(),M(),E()}),m.addEventListener("click",async()=>{if(!v)return;await navigator.clipboard.writeText(v);const t=m.innerHTML;m.innerHTML="<span>✓</span> Copied",m.classList.add("flash-success"),setTimeout(()=>{m.innerHTML=t,m.classList.remove("flash-success")},1500)}),G.addEventListener("click",()=>{if(!v)return;const t=ot[r]??".txt",e=new Blob([v],{type:"text/plain;charset=utf-8"}),c=URL.createObjectURL(e),n=document.createElement("a");n.href=c,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(c)});function j(t){const e=t.name.split(".").pop()??"",c=et(e);if(!c){g(`Unsupported file type ".${e}".

Supported file extensions: ${nt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{i.value=n.result,C(c),p.textContent=`Loaded: ${t.name}`,h()},n.readAsText(t)}x.addEventListener("change",()=>{x.files?.[0]&&j(x.files[0]),x.value=""}),l.addEventListener("dragover",t=>{t.preventDefault(),l.classList.add("drag-over"),$.style.display="flex"}),l.addEventListener("dragleave",t=>{l.contains(t.relatedTarget)||(l.classList.remove("drag-over"),$.style.display="none")}),l.addEventListener("drop",t=>{t.preventDefault(),l.classList.remove("drag-over"),$.style.display="none";const e=t.dataTransfer?.files[0];e&&j(e)}),R.addEventListener("change",h),U.addEventListener("change",h),S(),M(),E()}document.addEventListener("DOMContentLoaded",at);

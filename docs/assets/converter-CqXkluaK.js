import{d as et,F,c as nt,h as ot,I as st,a as at,e as rt,S as ct,b as G}from"./highlight-DXJTHkoR.js";const z="ingr-preferred-output-format",it={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function k(n){if(n===0)return"0 bytes";const s=Math.abs(n),l=s/(1024*1024),h=s/1024;if(s>=1024*1024){const o=Math.round(l*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(s>=1024){const o=Math.round(h*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(s)} bytes`}function X(n,s){if(!n||!s)return 0;if(s==="ingr"){const l=n.match(/:\s*/);if(!l)return 0;const h=l.index+l[0].length,o=n.split(`
`);let L=-1;for(let d=o.length-1;d>0;d--)if(o[d].startsWith("#")){L=d;break}let M=n.length;if(L>0){const d=n.indexOf(o[L]);M=n.lastIndexOf(`
`,d)}return M-h}return n.length}function lt(){const n=document.getElementById("input-area"),s=document.getElementById("output-area"),l=document.getElementById("input-tabs"),h=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),L=document.getElementById("output-tabs-spacer"),M=document.getElementById("convert-btn"),d=document.getElementById("clear-btn"),b=document.getElementById("copy-btn"),Y=document.getElementById("download-btn"),y=document.getElementById("detect-status"),j=document.getElementById("output-format-label"),I=document.getElementById("output-stats"),Z=document.getElementById("input-size"),q=document.getElementById("output-size"),p=document.getElementById("drop-zone"),w=document.getElementById("drop-overlay"),O=document.getElementById("file-input"),_=document.getElementById("output-delimiter"),H=document.getElementById("output-sha256");let m=null,i=localStorage.getItem(z)??"ingr",B="";function v(t,e=!1){B=e?"":t,s.classList.toggle("error",e),e?s.textContent=t:t&&Q()==="ingr"?s.innerHTML=ot(t):s.textContent=t}function A(){l.innerHTML=st.map(t=>`<button class="format-tab${t===m?" active":""}" data-fmt="${t}">${F[t]}</button>`).join("")}function S(){const t=m==="ingr";o.style.display=t?"block":"none",L.style.display=t?"none":"block",t&&(h.innerHTML=at.map(e=>`<button class="format-tab${e===i?" active":""}" data-fmt="${e}">${F[e]}</button>`).join(""))}function R(t,e=!1){m=t,A(),t&&t!=="ingr"&&(i=localStorage.getItem(z)??G(t)),S(),T(),P(),e&&E()}function J(t){i=t,localStorage.setItem(z,t),S(),T(),E()}function Q(){return m==="ingr"?i:"ingr"}function T(){i?j.textContent=`● ${F[i]??i}`:j.textContent=""}function P(){const t=X(n.value,m);Z.textContent=t>0?`(${k(t)})`:""}function V(t,e){const a=X(t,e);q.textContent=a>0?`(${k(a)})`:""}async function E(){const t=n.value.trim();if(!t){v(""),I.textContent="";return}let e=m;if(!e)if(e=et(t),e)R(e),y.textContent=`Detected: ${F[e]}`;else{v(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),y.textContent="",I.textContent="";return}const a=e==="ingr"?i:G(e);try{const r={ingrDelimiter:_.checked};let c=nt(t,e,a,r);if(H.checked&&a==="ingr"){const x=new TextEncoder().encode(c),g=await crypto.subtle.digest("SHA-256",x),$=Array.from(new Uint8Array(g)).map(f=>f.toString(16).padStart(2,"0")).join("");c=c+`
# sha256:`+$}v(c);const tt=c.split(`
`).length,N=new TextEncoder().encode(c).length,U=new TextEncoder().encode(n.value).length;let K=N;if(i==="ingr"){const u=c.match(/:\s*/);if(u){const x=u.index+u[0].length,g=c.split(`
`);let C=-1;for(let f=g.length-1;f>0;f--)if(g[f].startsWith("#")){C=f;break}let $=c.length;if(C>0){const f=c.indexOf(g[C]);$=c.lastIndexOf(`
`,f)}K=$-x}}let W=`${tt} lines · ${k(N)}`;if(U>0){const u=K-U,x=Math.round(u/U*100),g=u<0?"−":"+";W+=` · ${g}${Math.abs(x)}% (${k(Math.abs(u))})`}I.textContent=W,T(),V(c,a)}catch(r){v(r instanceof Error?r.message:String(r),!0),I.textContent=""}}l.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(R(e.dataset.fmt),y.textContent="")}),h.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&J(e.dataset.fmt)}),M.addEventListener("click",()=>{y.textContent="",E()}),d.addEventListener("click",()=>{n.value="",v(""),m=null,y.textContent="",I.textContent="",A(),S(),T()}),b.addEventListener("click",async()=>{if(!B)return;await navigator.clipboard.writeText(B);const t=b.innerHTML;b.innerHTML="<span>✓</span> Copied",b.classList.add("flash-success"),setTimeout(()=>{b.innerHTML=t,b.classList.remove("flash-success")},1500)}),Y.addEventListener("click",()=>{if(!B)return;const t=it[i]??".txt",e=new Blob([B],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=`converted${t}`,r.click(),URL.revokeObjectURL(a)});function D(t){const e=t.name.split(".").pop()??"",a=rt(e);if(!a){v(`Unsupported file type ".${e}".

Supported file extensions: ${ct.join(", ")}`,!0);return}const r=new FileReader;r.onload=()=>{n.value=r.result,R(a),y.textContent=`Loaded: ${t.name}`,E()},r.readAsText(t)}O.addEventListener("change",()=>{O.files?.[0]&&D(O.files[0]),O.value=""}),p.addEventListener("dragover",t=>{t.preventDefault(),p.classList.add("drag-over"),w.style.display="flex"}),p.addEventListener("dragleave",t=>{p.contains(t.relatedTarget)||(p.classList.remove("drag-over"),w.style.display="none")}),p.addEventListener("drop",t=>{t.preventDefault(),p.classList.remove("drag-over"),w.style.display="none";const e=t.dataTransfer?.files[0];e&&D(e)}),_.addEventListener("change",E),H.addEventListener("change",E),n.addEventListener("input",P),A(),S(),T(),P()}document.addEventListener("DOMContentLoaded",lt);

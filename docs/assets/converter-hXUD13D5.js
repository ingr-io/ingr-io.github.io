import{d as Y,F as B,c as Z,h as q,I as J,a as Q,e as V,S as tt,b as j}from"./highlight-BbQKTSrm.js";const C="ingr-preferred-output-format",et={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function _(c){if(c===0)return"0 bytes";const a=Math.abs(c),h=a/(1024*1024),v=a/1024;if(a>=1024*1024){const o=Math.round(h*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(a>=1024){const o=Math.round(v*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(a)} bytes`}function nt(){const c=document.getElementById("input-area"),a=document.getElementById("output-area"),h=document.getElementById("input-tabs"),v=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),H=document.getElementById("output-tabs-spacer"),D=document.getElementById("convert-btn"),N=document.getElementById("clear-btn"),i=document.getElementById("copy-btn"),P=document.getElementById("download-btn"),u=document.getElementById("detect-status"),F=document.getElementById("output-format-label"),g=document.getElementById("output-stats"),d=document.getElementById("drop-zone"),I=document.getElementById("drop-overlay"),E=document.getElementById("file-input"),k=document.getElementById("output-delimiter"),w=document.getElementById("output-sha256");let l=null,s=localStorage.getItem(C)??"ingr",y="";function m(t,e=!1){y=e?"":t,a.classList.toggle("error",e),e?a.textContent=t:t&&z()==="ingr"?a.innerHTML=q(t):a.textContent=t}function x(){h.innerHTML=J.map(t=>`<button class="format-tab${t===l?" active":""}" data-fmt="${t}">${B[t]}</button>`).join("")}function L(){const t=l==="ingr";o.style.display=t?"block":"none",H.style.display=t?"none":"block",t&&(v.innerHTML=Q.map(e=>`<button class="format-tab${e===s?" active":""}" data-fmt="${e}">${B[e]}</button>`).join(""))}function M(t,e=!1){l=t,x(),t&&t!=="ingr"&&(s=localStorage.getItem(C)??j(t)),L(),b(),e&&p()}function K(t){s=t,localStorage.setItem(C,t),L(),b(),p()}function z(){return l==="ingr"?s:"ingr"}function b(){s?F.textContent=`● ${B[s]??s}`:F.textContent=""}async function p(){const t=c.value.trim();if(!t){m(""),g.textContent="";return}let e=l;if(!e)if(e=Y(t),e)M(e),u.textContent=`Detected: ${B[e]}`;else{m(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),u.textContent="",g.textContent="";return}const r=e==="ingr"?s:j(e);try{const n={ingrDelimiter:k.checked};let f=Z(t,e,r,n);if(w.checked&&r==="ingr"){const $=new TextEncoder().encode(f),S=await crypto.subtle.digest("SHA-256",$),X=Array.from(new Uint8Array(S)).map(W=>W.toString(16).padStart(2,"0")).join("");f=f+`
# sha256:`+X}m(f);const G=f.split(`
`).length,R=new TextEncoder().encode(f).length,O=new TextEncoder().encode(c.value).length;let U=`${G} lines · ${_(R)}`;if(O>0){const T=R-O,$=Math.round(T/O*100),S=T<0?"−":"+";U+=` · ${S}${Math.abs($)}% (${_(Math.abs(T))})`}g.textContent=U,b()}catch(n){m(n instanceof Error?n.message:String(n),!0),g.textContent=""}}h.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(M(e.dataset.fmt),u.textContent="")}),v.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&K(e.dataset.fmt)}),D.addEventListener("click",()=>{u.textContent="",p()}),N.addEventListener("click",()=>{c.value="",m(""),l=null,u.textContent="",g.textContent="",x(),L(),b()}),i.addEventListener("click",async()=>{if(!y)return;await navigator.clipboard.writeText(y);const t=i.innerHTML;i.innerHTML="<span>✓</span> Copied",i.classList.add("flash-success"),setTimeout(()=>{i.innerHTML=t,i.classList.remove("flash-success")},1500)}),P.addEventListener("click",()=>{if(!y)return;const t=et[s]??".txt",e=new Blob([y],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(r)});function A(t){const e=t.name.split(".").pop()??"",r=V(e);if(!r){m(`Unsupported file type ".${e}".

Supported file extensions: ${tt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{c.value=n.result,M(r),u.textContent=`Loaded: ${t.name}`,p()},n.readAsText(t)}E.addEventListener("change",()=>{E.files?.[0]&&A(E.files[0]),E.value=""}),d.addEventListener("dragover",t=>{t.preventDefault(),d.classList.add("drag-over"),I.style.display="flex"}),d.addEventListener("dragleave",t=>{d.contains(t.relatedTarget)||(d.classList.remove("drag-over"),I.style.display="none")}),d.addEventListener("drop",t=>{t.preventDefault(),d.classList.remove("drag-over"),I.style.display="none";const e=t.dataTransfer?.files[0];e&&A(e)}),k.addEventListener("change",p),w.addEventListener("change",p),x(),L(),b()}document.addEventListener("DOMContentLoaded",nt);

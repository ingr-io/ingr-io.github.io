(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();function d(t){const n=t.split(`
`),e=n[n.length-1]===""?n.slice(0,-1):n;if(e.length===0)throw new Error("Empty file");const s=e[0].match(/^#\s+INGR\.io\s+\|\s+(.+?):\s+(.+)$/);if(!s)throw new Error("Invalid INGR header. Expected: # INGR.io | name: $ID, col2, ...");const o=s[1].trim(),r=s[2].split(",").map(u=>u.trim()),c=r.length;let i=e.length;for(let u=e.length-1;u>=1;u--)if(/^#\s+\d+\s+records?$/.test(e[u].trim())){i=u;break}const l=[];for(let u=1;u<i;u++){const m=e[u];m.startsWith("#")||l.push(m)}if(l.length%c!==0)throw new Error(`Data line count (${l.length}) is not divisible by column count (${c}). Expected ${c} lines per record.`);const a=[];for(let u=0;u<l.length;u+=c){const m={};for(let h=0;h<c;h++){const $=r[h].replace(/^\$/,""),y=l[u+h].trim();try{m[$]=JSON.parse(y)}catch{throw new Error(`Invalid JSON value on line ${u+h+2}: ${y}`)}}a.push(m)}return{recordsetName:o,columns:r,records:a}}function f(t,n=!1){const{recordsetName:e,columns:s,records:o}=t,r=[];r.push(`# INGR.io | ${e}: ${s.join(", ")}`);for(let i=0;i<o.length;i++){for(const l of s){const a=l.replace(/^\$/,"");r.push(JSON.stringify(o[i][a]??null))}n&&i<o.length-1&&r.push("#")}const c=o.length;return r.push(`# ${c} ${c===1?"record":"records"}`),r.join(`
`)}function p(t,n="data"){if(t.length===0)return{recordsetName:n,columns:["$ID"],records:[]};const e=new Set;for(const i of t)Object.keys(i).forEach(l=>e.add(l));const s=Array.from(e);let o=s.find(i=>i.toLowerCase()==="id")??s[0];const r=s.filter(i=>i!==o),c=[`$${o}`,...r];return{recordsetName:n,columns:c,records:t}}function v(t){const n=JSON.parse(t),e=Array.isArray(n)?n:[n];return f(p(e))}function w(t){const n=t.trim().split(`
`).filter(Boolean).map(e=>JSON.parse(e));return f(p(n))}function b(t){const n=S(t,",");return f(p(n))}function I(t){const n=S(t,"	");return f(p(n))}function T(t){const n=x(t);return f(p(n))}function E(t){const n=k(t);return f(p(n))}function P(t,n,e,s){const o=s?.ingrDelimiter??!1;if(n===e)return n==="ingr"?f(d(t),o):t;let r;if(n==="ingr")r=d(t);else{const c=L(t,n);r=d(c)}switch(e){case"ingr":return f(r,o);case"json":return JSON.stringify(r.records,null,2);case"jsonl":return r.records.map(c=>JSON.stringify(c)).join(`
`);case"csv":return N(r.records,",");case"tsv":return N(r.records,"	");case"yaml":return J(r.records);case"xml":return M(r.records,r.recordsetName);case"markdown":return R(r.records)}}function L(t,n){switch(n){case"json":return v(t);case"jsonl":return w(t);case"csv":return b(t);case"tsv":return I(t);case"yaml":return T(t);case"xml":return E(t);default:throw new Error(`Cannot convert from ${n} to INGR`)}}function S(t,n){const e=t.trim().split(`
`).filter(Boolean);if(e.length<2)throw new Error("CSV must have a header row and at least one data row");const s=j(e[0],n),o=[];for(let r=1;r<e.length;r++){const c=j(e[r],n),i={};for(let l=0;l<s.length;l++){const a=c[l]??"";i[s[l]]=g(a)}o.push(i)}return o}function j(t,n){const e=[];let s="",o=!1;for(let r=0;r<t.length;r++){const c=t[r];c==='"'?o&&t[r+1]==='"'?(s+='"',r++):o=!o:c===n&&!o?(e.push(s),s=""):s+=c}return e.push(s),e}function g(t){if(t===""||t.toLowerCase()==="null")return null;if(t.toLowerCase()==="true")return!0;if(t.toLowerCase()==="false")return!1;const n=Number(t);return!isNaN(n)&&t.trim()!==""?n:t}function N(t,n){if(t.length===0)return"";const e=Object.keys(t[0]),s=n===","?r=>r.includes(",")||r.includes('"')||r.includes(`
`)?`"${r.replace(/"/g,'""')}"`:r:r=>r;return[e.map(s).join(n),...t.map(r=>e.map(c=>{const i=r[c],l=i==null?"":String(i);return s(l)}).join(n))].join(`
`)}function x(t){const n=t.split(`
`),e=[];let s=null;for(const o of n){const r=o.trimEnd();if(!(r.trim()===""||r.trim()==="---")){if(/^- /.test(r)){s!==null&&e.push(s),s={};const c=r.replace(/^- /,"");if(c.trim()){const i=O(c);i&&s&&(s[i[0]]=i[1])}}else if(/^\s+/.test(r)&&s!==null){const c=O(r.trim());c&&(s[c[0]]=c[1])}}}return s!==null&&e.push(s),e}function O(t){const n=t.indexOf(":");if(n===-1)return null;const e=t.slice(0,n).trim(),s=t.slice(n+1).trim();return[e,C(s)]}function C(t){if(t===""||t==="null"||t==="~")return null;if(t==="true")return!0;if(t==="false")return!1;if(t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"'))return t.slice(1,-1);const n=Number(t);return!isNaN(n)&&t!==""?n:t}function J(t){return t.map(n=>"- "+Object.keys(n).map((s,o)=>{const r=n[s],c=`${s}: ${A(r)}`;return o===0?c:"  "+c}).join(`
`)).join(`
`)}function A(t){return t==null?"null":typeof t=="boolean"||typeof t=="number"?String(t):typeof t=="string"?/[:#\[\]{},&*!|>'"@`]/.test(t)||t.includes(`
`)||t===""?`"${t.replace(/"/g,'\\"')}"`:t:`"${JSON.stringify(t).replace(/"/g,'\\"')}"`}function k(t){const e=new DOMParser().parseFromString(t,"text/xml"),s=e.querySelector("parsererror");if(s)throw new Error("Invalid XML: "+s.textContent);const o=e.documentElement,r=[],c=Array.from(o.children);for(const i of c){const l={};if(i.children.length>0)for(const a of Array.from(i.children))l[a.tagName]=g(a.textContent??"");else{for(const a of Array.from(i.attributes))l[a.name]=g(a.value);i.textContent?.trim()&&(l.value=i.textContent.trim())}r.push(l)}return r}function M(t,n){const e=n.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,""),s=e.endsWith("s")?e.slice(0,-1):"record",o=['<?xml version="1.0" encoding="UTF-8"?>',`<${e}>`];for(const r of t){o.push(`  <${s}>`);for(const[c,i]of Object.entries(r)){const l=c.replace(/[^a-zA-Z0-9_-]/g,"_"),a=i==null?"":W(String(i));o.push(`    <${l}>${a}</${l}>`)}o.push(`  </${s}>`)}return o.push(`</${e}>`),o.join(`
`)}function W(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function R(t){if(t.length===0)return"";const n=Object.keys(t[0]),e=n.map(i=>Math.max(i.length,...t.map(l=>String(l[i]??"").length))),s=(i,l)=>i.padEnd(l),o="| "+n.map((i,l)=>s(i,e[l])).join(" | ")+" |",r="| "+e.map(i=>"-".repeat(i)).join(" | ")+" |",c=t.map(i=>"| "+n.map((l,a)=>s(String(i[l]??""),e[a])).join(" | ")+" |");return[o,r,...c].join(`
`)}function _(t){const n=t.trim();if(!n)return null;if(/^#\s+INGR\.io\s+\|/.test(n))return"ingr";if(n.startsWith("<?xml")||/^<[a-zA-Z]/.test(n))return"xml";if(n.startsWith("[")&&n.endsWith("]")||n.startsWith("{")&&n.endsWith("}"))try{return JSON.parse(n),"json"}catch{}const e=n.split(`
`).filter(Boolean);if(e.length>=2&&e.every(r=>{try{const c=JSON.parse(r.trim());return typeof c=="object"&&c!==null}catch{return!1}}))return"jsonl";if(e.length===1)try{if(typeof JSON.parse(e[0])=="object")return"json"}catch{}if(n.startsWith("---")||/^- \w+:/.test(n)||/^\w+:\s+/.test(n))return"yaml";const s=n.split(`
`).filter(Boolean).slice(0,5);if(s.length>=2){const o=(s[0].match(/,/g)??[]).length;if(o>0&&s.slice(1).every(c=>{const i=(c.match(/,/g)??[]).length;return Math.abs(i-o)<=1}))return"csv"}return s.length>=2&&s[0].includes("	")?"tsv":null}function G(t){return{json:"json",jsonl:"jsonl",ndjson:"jsonl",csv:"csv",tsv:"tsv",yaml:"yaml",yml:"yaml",xml:"xml",ingr:"ingr"}[t.toLowerCase()]??null}const D=[".json",".jsonl",".csv",".tsv",".yaml",".yml",".xml",".ingr"],K={ingr:"INGR",json:"JSON",jsonl:"JSONL",csv:"CSV",tsv:"TSV",yaml:"YAML",xml:"XML",markdown:"Markdown"},V=["json","jsonl","csv","tsv","yaml","xml","ingr"],B=["json","jsonl","csv","tsv","yaml","xml","markdown"];function U(t){return t==="ingr"?"json":"ingr"}function F(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function X(t){return t?t.split(`
`).map(n=>{const e=F(n);if(n.startsWith("#"))return`<span class="hl-meta">${e}</span>`;try{const s=JSON.parse(n.trim());return s===null?`<span class="hl-null">${e}</span>`:typeof s=="boolean"?`<span class="hl-bool">${e}</span>`:typeof s=="number"?`<span class="hl-number">${e}</span>`:typeof s=="string"?`<span class="hl-string">${e}</span>`:`<span class="hl-object">${e}</span>`}catch{return e}}).join(`
`):""}export{K as F,V as I,D as S,B as a,U as b,P as c,_ as d,G as e,X as h};

import{d as q,F as O,c as J,h as Q,I as V,a as tt,e as et,S as nt,b as P}from"./highlight-BNcuc9BJ.js";const F="ingr-preferred-output-format",ot={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function D(d){if(d===0)return"0 bytes";const s=Math.abs(d),B=s/(1024*1024),I=s/1024;if(s>=1024*1024){const o=Math.round(B*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(s>=1024){const o=Math.round(I*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(s)} bytes`}function at(){const d=document.getElementById("input-area"),s=document.getElementById("output-area"),B=document.getElementById("input-tabs"),I=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),N=document.getElementById("output-tabs-spacer"),K=document.getElementById("convert-btn"),z=document.getElementById("clear-btn"),m=document.getElementById("copy-btn"),G=document.getElementById("download-btn"),p=document.getElementById("detect-status"),w=document.getElementById("output-format-label"),b=document.getElementById("output-stats"),i=document.getElementById("drop-zone"),$=document.getElementById("drop-overlay"),x=document.getElementById("file-input"),A=document.getElementById("output-delimiter"),R=document.getElementById("output-sha256");let f=null,r=localStorage.getItem(F)??"ingr",v="";function g(t,e=!1){v=e?"":t,s.classList.toggle("error",e),e?s.textContent=t:t&&X()==="ingr"?s.innerHTML=Q(t):s.textContent=t}function S(){B.innerHTML=V.map(t=>`<button class="format-tab${t===f?" active":""}" data-fmt="${t}">${O[t]}</button>`).join("")}function M(){const t=f==="ingr";o.style.display=t?"block":"none",N.style.display=t?"none":"block",t&&(I.innerHTML=tt.map(e=>`<button class="format-tab${e===r?" active":""}" data-fmt="${e}">${O[e]}</button>`).join(""))}function C(t,e=!1){f=t,S(),t&&t!=="ingr"&&(r=localStorage.getItem(F)??P(t)),M(),E(),e&&h()}function W(t){r=t,localStorage.setItem(F,t),M(),E(),h()}function X(){return f==="ingr"?r:"ingr"}function E(){r?w.textContent=`● ${O[r]??r}`:w.textContent=""}async function h(){const t=d.value.trim();if(!t){g(""),b.textContent="";return}let e=f;if(!e)if(e=q(t),e)C(e),p.textContent=`Detected: ${O[e]}`;else{g(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),p.textContent="",b.textContent="";return}const c=e==="ingr"?r:P(e);try{const n={ingrDelimiter:A.checked};let a=J(t,e,c,n);if(R.checked&&c==="ingr"){const L=new TextEncoder().encode(a),y=await crypto.subtle.digest("SHA-256",L),u=Array.from(new Uint8Array(y)).map(Z=>Z.toString(16).padStart(2,"0")).join("");a=a+`
# sha256:`+u}g(a);const Y=a.split(`
`).length,j=new TextEncoder().encode(a).length,k=new TextEncoder().encode(d.value).length;let _=j;if(r==="ingr"){const l=a.match(/:\s*/);if(l){const L=a.indexOf(`
`,l.index)+1;let y=a.length;const T=a.split(`
`);for(let u=T.length-1;u>=0;u--)if(T[u].startsWith("#")&&!/^#\s+\d+\s+records?$/.test(T[u].trim())){y=a.lastIndexOf(T[u]);break}_=y-L}}let H=`${Y} lines · ${D(j)}`;if(k>0){const l=_-k,L=Math.round(l/k*100),y=l<0?"−":"+";H+=` · ${y}${Math.abs(L)}% (${D(Math.abs(l))})`}b.textContent=H,E()}catch(n){g(n instanceof Error?n.message:String(n),!0),b.textContent=""}}B.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(C(e.dataset.fmt),p.textContent="")}),I.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&W(e.dataset.fmt)}),K.addEventListener("click",()=>{p.textContent="",h()}),z.addEventListener("click",()=>{d.value="",g(""),f=null,p.textContent="",b.textContent="",S(),M(),E()}),m.addEventListener("click",async()=>{if(!v)return;await navigator.clipboard.writeText(v);const t=m.innerHTML;m.innerHTML="<span>✓</span> Copied",m.classList.add("flash-success"),setTimeout(()=>{m.innerHTML=t,m.classList.remove("flash-success")},1500)}),G.addEventListener("click",()=>{if(!v)return;const t=ot[r]??".txt",e=new Blob([v],{type:"text/plain;charset=utf-8"}),c=URL.createObjectURL(e),n=document.createElement("a");n.href=c,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(c)});function U(t){const e=t.name.split(".").pop()??"",c=et(e);if(!c){g(`Unsupported file type ".${e}".

Supported file extensions: ${nt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{d.value=n.result,C(c),p.textContent=`Loaded: ${t.name}`,h()},n.readAsText(t)}x.addEventListener("change",()=>{x.files?.[0]&&U(x.files[0]),x.value=""}),i.addEventListener("dragover",t=>{t.preventDefault(),i.classList.add("drag-over"),$.style.display="flex"}),i.addEventListener("dragleave",t=>{i.contains(t.relatedTarget)||(i.classList.remove("drag-over"),$.style.display="none")}),i.addEventListener("drop",t=>{t.preventDefault(),i.classList.remove("drag-over"),$.style.display="none";const e=t.dataTransfer?.files[0];e&&U(e)}),A.addEventListener("change",h),R.addEventListener("change",h),S(),M(),E()}document.addEventListener("DOMContentLoaded",at);

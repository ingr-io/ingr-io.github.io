import{d as W,F as $,c as Y,h as Z,I as q,a as J,e as Q,S as tt,b as D}from"./highlight-CDUcPZ9v.js";const k="ingr-preferred-output-format",et={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function N(s){if(s===0)return"0 bytes";const r=1024,h=["bytes","KB","MB","GB"],c=Math.floor(Math.log(Math.abs(s))/Math.log(r)),y=s/Math.pow(r,c),d=[];if(c>=2){const v=Math.floor(y),T=Math.round((y-v)*r);v>0&&d.push(`${v}MB`),T>0&&d.push(`${T}${h[c-1]}`)}else d.push(`${Math.round(y)}${h[c]}`);return d.join(" ")}function nt(){const s=document.getElementById("input-area"),r=document.getElementById("output-area"),h=document.getElementById("input-tabs"),c=document.getElementById("output-tabs"),y=document.getElementById("output-tabs-wrapper"),d=document.getElementById("output-tabs-spacer"),v=document.getElementById("convert-btn"),T=document.getElementById("clear-btn"),l=document.getElementById("copy-btn"),P=document.getElementById("download-btn"),u=document.getElementById("detect-status"),A=document.getElementById("output-format-label"),b=document.getElementById("output-stats"),i=document.getElementById("drop-zone"),O=document.getElementById("drop-overlay"),B=document.getElementById("file-input"),R=document.getElementById("output-delimiter"),U=document.getElementById("output-sha256");let p=null,o=localStorage.getItem(k)??"ingr",E="";function m(t,e=!1){E=e?"":t,r.classList.toggle("error",e),e?r.textContent=t:t&&G()==="ingr"?r.innerHTML=Z(t):r.textContent=t}function S(){h.innerHTML=q.map(t=>`<button class="format-tab${t===p?" active":""}" data-fmt="${t}">${$[t]}</button>`).join("")}function I(){const t=p==="ingr";y.style.display=t?"block":"none",d.style.display=t?"none":"block",t&&(c.innerHTML=J.map(e=>`<button class="format-tab${e===o?" active":""}" data-fmt="${e}">${$[e]}</button>`).join(""))}function C(t,e=!1){p=t,S(),t&&t!=="ingr"&&(o=localStorage.getItem(k)??D(t)),I(),L(),e&&f()}function z(t){o=t,localStorage.setItem(k,t),I(),L(),f()}function G(){return p==="ingr"?o:"ingr"}function L(){o?A.textContent=`● ${$[o]??o}`:A.textContent=""}async function f(){const t=s.value.trim();if(!t){m(""),b.textContent="";return}let e=p;if(!e)if(e=W(t),e)C(e),u.textContent=`Detected: ${$[e]}`;else{m(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),u.textContent="",b.textContent="";return}const a=e==="ingr"?o:D(e);try{const n={ingrDelimiter:R.checked};let g=Y(t,e,a,n);if(U.checked&&a==="ingr"){const F=new TextEncoder().encode(g),M=await crypto.subtle.digest("SHA-256",F),X=Array.from(new Uint8Array(M)).map(V=>V.toString(16).padStart(2,"0")).join("");g=g+`
# sha256:`+X}m(g);const K=g.split(`
`).length,_=new TextEncoder().encode(g).length,w=new TextEncoder().encode(s.value).length;let H=`${K} lines · ${N(_)}`;if(w>0){const x=_-w,F=Math.round(x/w*100),M=x<0?"−":"+";H+=` · ${M}${Math.abs(F)}% (${M}${N(Math.abs(x))})`}b.textContent=H,L()}catch(n){m(n instanceof Error?n.message:String(n),!0),b.textContent=""}}h.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(C(e.dataset.fmt),u.textContent="")}),c.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&z(e.dataset.fmt)}),v.addEventListener("click",()=>{u.textContent="",f()}),T.addEventListener("click",()=>{s.value="",m(""),p=null,u.textContent="",b.textContent="",S(),I(),L()}),l.addEventListener("click",async()=>{if(!E)return;await navigator.clipboard.writeText(E);const t=l.innerHTML;l.innerHTML="<span>✓</span> Copied",l.classList.add("flash-success"),setTimeout(()=>{l.innerHTML=t,l.classList.remove("flash-success")},1500)}),P.addEventListener("click",()=>{if(!E)return;const t=et[o]??".txt",e=new Blob([E],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(a)});function j(t){const e=t.name.split(".").pop()??"",a=Q(e);if(!a){m(`Unsupported file type ".${e}".

Supported file extensions: ${tt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{s.value=n.result,C(a),u.textContent=`Loaded: ${t.name}`,f()},n.readAsText(t)}B.addEventListener("change",()=>{B.files?.[0]&&j(B.files[0]),B.value=""}),i.addEventListener("dragover",t=>{t.preventDefault(),i.classList.add("drag-over"),O.style.display="flex"}),i.addEventListener("dragleave",t=>{i.contains(t.relatedTarget)||(i.classList.remove("drag-over"),O.style.display="none")}),i.addEventListener("drop",t=>{t.preventDefault(),i.classList.remove("drag-over"),O.style.display="none";const e=t.dataTransfer?.files[0];e&&j(e)}),R.addEventListener("change",f),U.addEventListener("change",f),S(),I(),L()}document.addEventListener("DOMContentLoaded",nt);

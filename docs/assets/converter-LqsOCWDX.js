import{d as q,F as M,c as J,h as Q,I as V,a as tt,e as et,S as nt,b as H}from"./highlight-BbQKTSrm.js";const w="ingr-preferred-output-format",ot={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function D(i){if(i===0)return"0 bytes";const a=Math.abs(i),T=a/(1024*1024),B=a/1024;if(a>=1024*1024){const o=Math.round(T*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(a>=1024){const o=Math.round(B*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(a)} bytes`}function at(){const i=document.getElementById("input-area"),a=document.getElementById("output-area"),T=document.getElementById("input-tabs"),B=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),N=document.getElementById("output-tabs-spacer"),P=document.getElementById("convert-btn"),K=document.getElementById("clear-btn"),u=document.getElementById("copy-btn"),z=document.getElementById("download-btn"),m=document.getElementById("detect-status"),F=document.getElementById("output-format-label"),b=document.getElementById("output-stats"),d=document.getElementById("drop-zone"),$=document.getElementById("drop-overlay"),I=document.getElementById("file-input"),A=document.getElementById("output-delimiter"),R=document.getElementById("output-sha256");let p=null,s=localStorage.getItem(w)??"ingr",v="";function f(t,e=!1){v=e?"":t,a.classList.toggle("error",e),e?a.textContent=t:t&&X()==="ingr"?a.innerHTML=Q(t):a.textContent=t}function O(){T.innerHTML=V.map(t=>`<button class="format-tab${t===p?" active":""}" data-fmt="${t}">${M[t]}</button>`).join("")}function x(){const t=p==="ingr";o.style.display=t?"block":"none",N.style.display=t?"none":"block",t&&(B.innerHTML=tt.map(e=>`<button class="format-tab${e===s?" active":""}" data-fmt="${e}">${M[e]}</button>`).join(""))}function S(t,e=!1){p=t,O(),t&&t!=="ingr"&&(s=localStorage.getItem(w)??H(t)),x(),E(),e&&g()}function G(t){s=t,localStorage.setItem(w,t),x(),E(),g()}function X(){return p==="ingr"?s:"ingr"}function E(){s?F.textContent=`● ${M[s]??s}`:F.textContent=""}async function g(){const t=i.value.trim();if(!t){f(""),b.textContent="";return}let e=p;if(!e)if(e=q(t),e)S(e),m.textContent=`Detected: ${M[e]}`;else{f(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),m.textContent="",b.textContent="";return}const r=e==="ingr"?s:H(e);try{const n={ingrDelimiter:A.checked};let l=J(t,e,r,n);if(R.checked&&r==="ingr"){const h=new TextEncoder().encode(l),y=await crypto.subtle.digest("SHA-256",h),Y=Array.from(new Uint8Array(y)).map(Z=>Z.toString(16).padStart(2,"0")).join("");l=l+`
# sha256:`+Y}f(l);const W=l.split(`
`).length,j=new TextEncoder().encode(l).length,C=new TextEncoder().encode(i.value).length;let k=j;if(s==="ingr"){const c=l.split(`
`);let h=c.length;for(let L=c.length-1;L>=1;L--)if(/^#\s+\d+\s+records?$/.test(c[L].trim())){h=L;break}const y=c.slice(1,h);y.length>0?k=new TextEncoder().encode(y.join(`
`)+`
`).length:k=0}let _=`${W} lines · ${D(j)}`;if(C>0){const c=k-C,h=Math.round(c/C*100),y=c<0?"−":"+";_+=` · ${y}${Math.abs(h)}% (${D(Math.abs(c))})`}b.textContent=_,E()}catch(n){f(n instanceof Error?n.message:String(n),!0),b.textContent=""}}T.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(S(e.dataset.fmt),m.textContent="")}),B.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&G(e.dataset.fmt)}),P.addEventListener("click",()=>{m.textContent="",g()}),K.addEventListener("click",()=>{i.value="",f(""),p=null,m.textContent="",b.textContent="",O(),x(),E()}),u.addEventListener("click",async()=>{if(!v)return;await navigator.clipboard.writeText(v);const t=u.innerHTML;u.innerHTML="<span>✓</span> Copied",u.classList.add("flash-success"),setTimeout(()=>{u.innerHTML=t,u.classList.remove("flash-success")},1500)}),z.addEventListener("click",()=>{if(!v)return;const t=ot[s]??".txt",e=new Blob([v],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(r)});function U(t){const e=t.name.split(".").pop()??"",r=et(e);if(!r){f(`Unsupported file type ".${e}".

Supported file extensions: ${nt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{i.value=n.result,S(r),m.textContent=`Loaded: ${t.name}`,g()},n.readAsText(t)}I.addEventListener("change",()=>{I.files?.[0]&&U(I.files[0]),I.value=""}),d.addEventListener("dragover",t=>{t.preventDefault(),d.classList.add("drag-over"),$.style.display="flex"}),d.addEventListener("dragleave",t=>{d.contains(t.relatedTarget)||(d.classList.remove("drag-over"),$.style.display="none")}),d.addEventListener("drop",t=>{t.preventDefault(),d.classList.remove("drag-over"),$.style.display="none";const e=t.dataTransfer?.files[0];e&&U(e)}),A.addEventListener("change",g),R.addEventListener("change",g),O(),x(),E()}document.addEventListener("DOMContentLoaded",at);

import{d as q,F as $,c as J,h as Q,I as V,a as tt,e as et,S as nt,b as D}from"./highlight-BNcuc9BJ.js";const w="ingr-preferred-output-format",ot={ingr:".ingr",json:".json",jsonl:".jsonl",csv:".csv",tsv:".tsv",yaml:".yaml",xml:".xml",markdown:".md"};function N(l){if(l===0)return"0 bytes";const s=Math.abs(l),T=s/(1024*1024),B=s/1024;if(s>=1024*1024){const o=Math.round(T*10)/10;return o===Math.floor(o)?`${Math.floor(o)}MB`:`${o}MB`}if(s>=1024){const o=Math.round(B*10)/10;return o===Math.floor(o)?`${Math.floor(o)}KB`:`${o}KB`}return`${Math.floor(s)} bytes`}function at(){const l=document.getElementById("input-area"),s=document.getElementById("output-area"),T=document.getElementById("input-tabs"),B=document.getElementById("output-tabs"),o=document.getElementById("output-tabs-wrapper"),K=document.getElementById("output-tabs-spacer"),z=document.getElementById("convert-btn"),G=document.getElementById("clear-btn"),m=document.getElementById("copy-btn"),W=document.getElementById("download-btn"),p=document.getElementById("detect-status"),A=document.getElementById("output-format-label"),y=document.getElementById("output-stats"),u=document.getElementById("drop-zone"),C=document.getElementById("drop-overlay"),I=document.getElementById("file-input"),R=document.getElementById("output-delimiter"),U=document.getElementById("output-sha256");let g=null,r=localStorage.getItem(w)??"ingr",v="";function h(t,e=!1){v=e?"":t,s.classList.toggle("error",e),e?s.textContent=t:t&&Y()==="ingr"?s.innerHTML=Q(t):s.textContent=t}function S(){T.innerHTML=V.map(t=>`<button class="format-tab${t===g?" active":""}" data-fmt="${t}">${$[t]}</button>`).join("")}function x(){const t=g==="ingr";o.style.display=t?"block":"none",K.style.display=t?"none":"block",t&&(B.innerHTML=tt.map(e=>`<button class="format-tab${e===r?" active":""}" data-fmt="${e}">${$[e]}</button>`).join(""))}function F(t,e=!1){g=t,S(),t&&t!=="ingr"&&(r=localStorage.getItem(w)??D(t)),x(),E(),e&&b()}function X(t){r=t,localStorage.setItem(w,t),x(),E(),b()}function Y(){return g==="ingr"?r:"ingr"}function E(){r?A.textContent=`● ${$[r]??r}`:A.textContent=""}async function b(){const t=l.value.trim();if(!t){h(""),y.textContent="";return}let e=g;if(!e)if(e=q(t),e)F(e),p.textContent=`Detected: ${$[e]}`;else{h(`Format not recognised.

Please choose the input format manually using the tabs above the input area.`,!0),p.textContent="",y.textContent="";return}const c=e==="ingr"?r:D(e);try{const n={ingrDelimiter:R.checked};let a=J(t,e,c,n);if(U.checked&&c==="ingr"){const L=new TextEncoder().encode(a),f=await crypto.subtle.digest("SHA-256",L),O=Array.from(new Uint8Array(f)).map(d=>d.toString(16).padStart(2,"0")).join("");a=a+`
# sha256:`+O}h(a);const Z=a.split(`
`).length,P=new TextEncoder().encode(a).length,k=new TextEncoder().encode(l.value).length;let _=P;if(r==="ingr"){const i=a.match(/:\s*/);if(i){const L=i.index+i[0].length,f=a.split(`
`);let M=-1;for(let d=f.length-1;d>0;d--)if(f[d].startsWith("#")){M=d;break}let O=a.length;if(M>0){const d=a.indexOf(f[M]);O=a.lastIndexOf(`
`,d)}_=O-L}}let H=`${Z} lines · ${N(P)}`;if(k>0){const i=_-k,L=Math.round(i/k*100),f=i<0?"−":"+";H+=` · ${f}${Math.abs(L)}% (${N(Math.abs(i))})`}y.textContent=H,E()}catch(n){h(n instanceof Error?n.message:String(n),!0),y.textContent=""}}T.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&(F(e.dataset.fmt),p.textContent="")}),B.addEventListener("click",t=>{const e=t.target.closest(".format-tab");e?.dataset.fmt&&X(e.dataset.fmt)}),z.addEventListener("click",()=>{p.textContent="",b()}),G.addEventListener("click",()=>{l.value="",h(""),g=null,p.textContent="",y.textContent="",S(),x(),E()}),m.addEventListener("click",async()=>{if(!v)return;await navigator.clipboard.writeText(v);const t=m.innerHTML;m.innerHTML="<span>✓</span> Copied",m.classList.add("flash-success"),setTimeout(()=>{m.innerHTML=t,m.classList.remove("flash-success")},1500)}),W.addEventListener("click",()=>{if(!v)return;const t=ot[r]??".txt",e=new Blob([v],{type:"text/plain;charset=utf-8"}),c=URL.createObjectURL(e),n=document.createElement("a");n.href=c,n.download=`converted${t}`,n.click(),URL.revokeObjectURL(c)});function j(t){const e=t.name.split(".").pop()??"",c=et(e);if(!c){h(`Unsupported file type ".${e}".

Supported file extensions: ${nt.join(", ")}`,!0);return}const n=new FileReader;n.onload=()=>{l.value=n.result,F(c),p.textContent=`Loaded: ${t.name}`,b()},n.readAsText(t)}I.addEventListener("change",()=>{I.files?.[0]&&j(I.files[0]),I.value=""}),u.addEventListener("dragover",t=>{t.preventDefault(),u.classList.add("drag-over"),C.style.display="flex"}),u.addEventListener("dragleave",t=>{u.contains(t.relatedTarget)||(u.classList.remove("drag-over"),C.style.display="none")}),u.addEventListener("drop",t=>{t.preventDefault(),u.classList.remove("drag-over"),C.style.display="none";const e=t.dataTransfer?.files[0];e&&j(e)}),R.addEventListener("change",b),U.addEventListener("change",b),S(),x(),E()}document.addEventListener("DOMContentLoaded",at);
